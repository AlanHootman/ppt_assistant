# PPTè‡ªåŠ¨ç”Ÿæˆç³»ç»Ÿ

åŸºäºLangGraphçš„PPTè‡ªåŠ¨ç”Ÿæˆç³»ç»Ÿï¼Œå¯ä»¥å°†Markdownæ–‡æ¡£è‡ªåŠ¨è½¬æ¢ä¸ºPPTæ¼”ç¤ºæ–‡ç¨¿ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- Markdownè§£æï¼šè‡ªåŠ¨è§£æMarkdownæ–‡æ¡£ç»“æ„
- PPTæ¨¡æ¿åˆ†æï¼šåˆ†æPPTæ¨¡æ¿çš„å¸ƒå±€å’Œé£æ ¼
- æ™ºèƒ½å¸ƒå±€å†³ç­–ï¼šåŒ¹é…å†…å®¹ä¸åˆé€‚çš„PPTå¸ƒå±€
- è‡ªåŠ¨ç”ŸæˆPPTï¼šæ ¹æ®è§£æç»“æœç”Ÿæˆæœ€ç»ˆçš„PPTæ–‡ä»¶

## æ¼”ç¤ºDemo

https://github.com/user-attachments/assets/4292de8d-6f46-43c9-96b3-66e6f5b2add9


## éƒ¨ç½²æ–¹æ³•

### æ–¹å¼ä¸€ï¼šä½¿ç”¨Dockeréƒ¨ç½²

```bash
cd docker

# ç¼–è¾‘.envæ–‡ä»¶
cp .env.example .env

# æ‰§è¡Œéƒ¨ç½²è„šæœ¬
./deploy.sh build
# æ‰§è¡Œå¯åŠ¨è„šæœ¬
./deploy.sh start
```
> å¤‡æ³¨ï¼š
> - éœ€è¦æå‰å®‰è£…å¥½dockerå’Œdocker-compose


### æ–¹å¼äºŒï¼šä½¿ç”¨æœ¬åœ°ç¯å¢ƒéƒ¨ç½²(é€‚ç”¨äºå¼€å‘è°ƒè¯•)

#### 1. å®‰è£…ä¾èµ–

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
conda create -n ppt_gen python=3.12
conda activate ppt_gen

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# åˆå§‹åŒ–å­æ¨¡å—
git submodule update --init

# å®‰è£…ppt_manager
cd libs/ppt_manager
pip install -e .
```

#### 2. å®‰è£…LibreOffice

Macç”¨æˆ·å¯ä»¥é€šè¿‡brewå®‰è£…LibreOffice

```bash
brew install --cask libreoffice
```

å®‰è£…ä¹‹ååˆ›å»ºsofficeçš„å‘½ä»¤è„šæœ¬
```bash
# åˆ›å»ºè½¯é“¾æ¥
sudo tee /usr/local/bin/soffice <<EOF
#!/bin/bash
/Applications/LibreOffice.app/Contents/MacOS/soffice "\$@"
EOF

# èµ‹äºˆæ‰§è¡Œæƒé™
sudo chmod +x /usr/local/bin/soffice

```

éªŒè¯å®‰è£…
```bash
soffice --version
```
#### 3. å®‰è£…poppler

Macç”¨æˆ·å¯ä»¥é€šè¿‡brewå®‰è£…poppler
```bash
brew install poppler
```
Linuxç”¨æˆ·å¯ä»¥é€šè¿‡aptå®‰è£…poppler
```bash
sudo apt-get install poppler-utils
```

Windowsç”¨æˆ·éœ€è¦æ‰‹åŠ¨ä¸‹è½½å®‰è£…
ä¸‹è½½åœ°å€ï¼šhttps://poppler.freedesktop.org/

#### 4. è¿è¡Œ
##### 4.1 å¤åˆ¶é…ç½®æ–‡ä»¶
```bash
cp .env.example .env
```

##### 4.2 å¯åŠ¨redisæœåŠ¡
```bash
docker-compose -f docker/docker-compose-dev.yml up -d
```

##### 4.3 å¯åŠ¨åç«¯FastAPIæœåŠ¡
```bash
uvicorn apps.api.main:app --reload --host 0.0.0.0 --port 8000
```

##### 4.4 å¯åŠ¨celeryæœåŠ¡
```bash
celery -A apps.api.celery_app worker --loglevel=info --concurrency=2 --pool=solo -Q celery,template_analysis,ppt_generation
```
##### 4.5 å¯åŠ¨mlflowæœåŠ¡
```bash
python scripts/start_mlflow_ui.py
```

##### 4.6 å¯åŠ¨å‰ç«¯VueæœåŠ¡
```bash
cd apps/web
npm install --legacy-peer-deps
npm run dev
```

## ä½¿ç”¨æ–¹æ³•
1. è®¿é—®å‰ç«¯é¡µé¢
> - dockeréƒ¨ç½²ï¼šhttp://localhost  
> - æœ¬åœ°éƒ¨ç½²ï¼šhttp://localhost:5173

2. è®¿é—®ç®¡ç†åå°ï¼šç‚¹å‡»å‰ç«¯é¡µé¢å³ä¸Šè§’ç®¡ç†åå°æŒ‰é’®ï¼Œè¿›å…¥ç®¡ç†åå°é¡µé¢(admin/admin123)

3. é…ç½®API_KEYï¼šç‚¹å‡»ç®¡ç†åå°ï¼Œåˆ†åˆ«é…ç½®LLMã€VLLMã€deepthinkçš„API Key
![](./docs/assets/screen_console.png)

> å¤‡æ³¨ï¼š
> - æ¨¡å‹é…ç½®ä¸­çš„æ–‡æœ¬æ¨¡å‹(LLM)å’Œæ·±åº¦æ€è€ƒ(deepthink)ï¼Œæœ¬è´¨éƒ½æ˜¯æ–‡æœ¬å¤§æ¨¡å‹ã€‚
> - å‰è€…ä¸€èˆ¬æ‰¿æ‹…æ¯”è¾ƒè½»é‡çº§çš„ä»»åŠ¡ï¼Œåè€…ä¸€èˆ¬æ‰¿æ‹…ä¸Šä¸‹æ–‡æ¯”è¾ƒé•¿çš„åˆ†æä»»åŠ¡ï¼Œä¸ºäº†èŠ‚çœtokenæ¶ˆè€—ï¼ŒåŒºåˆ†ä½¿ç”¨ï¼Œä½†éƒ½éœ€è¦é…ç½®ã€‚

4. ä¸Šä¼ PPTæ¨¡æ¿ï¼šåœ¨ç®¡ç†åå°ï¼Œä¸Šä¼ PPTæ¨¡æ¿æ–‡ä»¶ï¼Œç¨ç­‰åˆ†æå®Œæ¯•åï¼Œå³å¯åœ¨ç®¡ç†åå°çœ‹åˆ°åˆ†æç»“æœ

5. åœ¨å‰ç«¯é¡µé¢ï¼Œè¾“å…¥Markdownæ–‡æ¡£ï¼Œç‚¹å‡»ç”ŸæˆPPTæŒ‰é’®
![](./docs/assets/screen_home.png)

6. ä¸‹è½½PPTï¼šå¾…æç¤ºPPTç”Ÿæˆå®Œæ¯•åï¼Œç‚¹å‡»PPTæ–‡ä»¶ï¼Œå³å¯ä¸‹è½½PPTæ–‡ä»¶


## å¸¸è§é—®é¢˜
- **é—®é¢˜1**ï¼š PPTç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œæç¤º"å†…å®¹è§„åˆ’å¤±è´¥ï¼Œæ— æ³•è·å–å†…å®¹è§„åˆ’ç»“æœ".
>é—®é¢˜åŸå› ï¼šè¿™ç§æƒ…å†µæ˜¯å¤§æ¨¡å‹è¿”å›çš„å†…å®¹å­˜åœ¨å¼‚å¸¸ï¼Œæ¯”å¦‚ï¼šæœªæŒ‰ç…§è¦æ±‚è¿”å›ã€‚å…·ä½“å¯ä»¥é€šè¿‡mlflowè°ƒè¯•é¡µé¢æŸ¥çœ‹è¿”å›å†…å®¹ã€‚
 
  
- **é—®é¢˜2**ï¼š PPTç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œç”Ÿæˆçš„PPTæ–‡ä»¶å†…å®¹ä¸å…¨ï¼Œå­˜åœ¨éƒ¨åˆ†å†…å®¹ç¼ºå¤±ã€‚
> é—®é¢˜åŸå› ï¼šè¿™ç§æƒ…å†µæ˜¯å› ä¸ºå¤§æ¨¡å‹åœ¨è¿›è¡Œå†…å®¹è§„åˆ’æ—¶ï¼Œå¯¹éƒ¨åˆ†å†…å®¹è¿›è¡Œäº†åˆ å‡æ‰€è‡´ã€‚è¯¥é—®é¢˜è§£å†³æ–¹å¼åŒé—®é¢˜1ã€‚


- **é—®é¢˜3**ï¼š å¼€å¯å¤šæ¨¡æ€èƒ½åŠ›æ£€æµ‹ï¼ŒPPTç”Ÿæˆæ—¶é—´å˜å¾—å¾ˆé•¿ã€‚
> é—®é¢˜åŸå› ï¼šç”±äºç›®å‰PPTçš„è§†è§‰æ£€æµ‹ï¼Œä¸»è¦æ˜¯ä¾èµ–äºsofficeçš„PPTè½¬å›¾ç‰‡ï¼Œè¿™ä¸€è¿‡ç¨‹é€Ÿåº¦æ…¢ä¸”æ— æ³•ä¼˜åŒ–å¹²é¢„ï¼Œæ‰€ä»¥æš‚æ—¶æ²¡æœ‰å¥½çš„è§£å†³æ–¹æ¡ˆã€‚

å¤‡æ³¨ï¼šå„ä¸ªæ¨¡å‹åœ¨ä¸åŒä»»åŠ¡ä¸Šçš„è¡¨ç°ï¼Œå¯ä»¥å‚è€ƒ[æ¨¡å‹å¯¹æ¯”](./docs/report/PPTç”Ÿæˆå„æ¨¡å‹å®éªŒç»“æœ.md)


## é¡¹ç›®ç»“æ„

```bash
ppt-assisstant/
â”œâ”€â”€ apps/                  # åº”ç”¨å±‚
â”‚   â”œâ”€â”€ api/               # FastAPIæ¥å£æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ routers/       # æ¥å£è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ agent.py   # Agentèƒ½åŠ›æ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ file.py    # æ–‡ä»¶å¤„ç†æ¥å£
â”‚   â”‚   â”œâ”€â”€ models/        # æ¥å£æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ dependencies/  # æ¥å£ä¾èµ–é¡¹
â”‚   â”‚   â””â”€â”€ main.py        # FastAPIå…¥å£
â”‚   â”‚
â”‚   â””â”€â”€ web/               # å‰ç«¯å·¥ç¨‹
â”‚       â”œâ”€â”€ public/        # é™æ€èµ„æº
â”‚       â”œâ”€â”€ src/           # å‰ç«¯æºç 
â”‚       â””â”€â”€ package.json   # å‰ç«¯ä¾èµ–
â”‚
â”œâ”€â”€ core/                  # æ ¸å¿ƒä¸šåŠ¡
â”‚   â”œâ”€â”€ agents/            # LangGraph Agentå®ç°
â”‚   â”‚   â”œâ”€â”€ markdown_agent.py           # Markdownè§£æ
â”‚   â”‚   â”œâ”€â”€ ppt_analysis_agent.py       # PPTåˆ†æ
â”‚   â”‚   â”œâ”€â”€ content_planning_agent.py   # å†…å®¹è§„åˆ’
â”‚   â”‚   â”œâ”€â”€ slide_generator_agent.py    # å¹»ç¯ç‰‡ç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ ppt_finalizer_agent.py      # PPTæ¸…ç†ä¸ä¿å­˜
â”‚   â”‚   â””â”€â”€ base_agent.py               # åŸºç¡€Agent
â”‚   â”‚
â”‚   â”œâ”€â”€ workflows/         # å·¥ä½œæµé…ç½®
â”‚   â”‚   â”œâ”€â”€ ppt_gen.yaml   # ä¸»å·¥ä½œæµé…ç½®
â”‚   â”‚   â””â”€â”€ utils.py       # å·¥ä½œæµå·¥å…·
â”‚   â”‚
â”‚   â””â”€â”€ engine/            # æ‰§è¡Œå¼•æ“
â”‚       â”œâ”€â”€ state.py       # çŠ¶æ€ç®¡ç†
â”‚       â””â”€â”€ workflow.py    # å·¥ä½œæµå¼•æ“
â”‚
â”œâ”€â”€ libs/                  # ç¬¬ä¸‰æ–¹åº“
â”‚   â”œâ”€â”€ ppt_manager/       # PPTæ“ä½œåº“ï¼ˆgitå­æ¨¡å—ï¼‰
â”‚   â””â”€â”€ ...                # å…¶ä»–å­æ¨¡å—
â”‚
â”œâ”€â”€ workspace/             # è¿è¡Œæ—¶æ–‡ä»¶
â”‚   â”œâ”€â”€ sessions/          # ä¼šè¯æ•°æ®
â”‚   â”‚   â””â”€â”€ {session_id}/  # æŒ‰ä¼šè¯éš”ç¦»
â”‚   â”œâ”€â”€ cache/             # ç¼“å­˜æ–‡ä»¶
â”‚   â”œâ”€â”€ logs/              # ç³»ç»Ÿæ—¥å¿—
â”‚   â”œâ”€â”€ mlflow/            # mlflowè°ƒè¯•æ—¥å¿—
â”‚   â”œâ”€â”€ outputs/           # è¾“å‡ºæ–‡ä»¶
â”‚   â”œâ”€â”€ data/              # æ•°æ®æ–‡ä»¶
â”‚   â””â”€â”€ temp/              # ä¸´æ—¶æ–‡ä»¶
â”‚
â”œâ”€â”€ config/                # é…ç½®ä¸­å¿ƒ
â”‚   â”œâ”€â”€ prompts/           # æç¤ºè¯
â”‚   â”œâ”€â”€ settings.py        # åº”ç”¨é…ç½®
â”‚   â””â”€â”€ model_config.yaml  # æ¨¡å‹é…ç½®
â”‚
â”œâ”€â”€ docs/                  # æ–‡æ¡£ä¸­å¿ƒ
â”‚   â”œâ”€â”€ arch/              # æ¶æ„è®¾è®¡
â”‚   â”œâ”€â”€ report/            # æŠ¥å‘Š
â”‚   â”œâ”€â”€ prd/               # éœ€æ±‚æ–‡æ¡£
â”‚   â””â”€â”€ api/               # APIæ–‡æ¡£
â”‚
â”œâ”€â”€ tests/                 # æµ‹è¯•ä½“ç³»
â”‚   â”œâ”€â”€ test_files/        # æµ‹è¯•æ–‡ä»¶
â”‚   â””â”€â”€ test_utils.py      # æµ‹è¯•å·¥å…·
â”‚
â”œâ”€â”€ Dockerfile             # å®¹å™¨åŒ–æ„å»º
â”œâ”€â”€ docker-compose.yml     # æœåŠ¡ç¼–æ’
â””â”€â”€ requirements.txt       # Pythonä¾èµ–
```



## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ **Apache License 2.0** å¼€æºè®¸å¯è¯ã€‚

### å•†ä¸šä½¿ç”¨è¯´æ˜

- âœ… **å¼€æºå…è´¹ä½¿ç”¨**ï¼šæ‚¨å¯ä»¥è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘æœ¬è½¯ä»¶
- âœ… **å•†ä¸šç”¨é€”å‹å¥½**ï¼šå…è®¸åœ¨å•†ä¸šé¡¹ç›®ä¸­ä½¿ç”¨ï¼Œæ— éœ€æ”¯ä»˜è®¸å¯è´¹
- âœ… **ä¸“åˆ©ä¿æŠ¤**ï¼šæä¾›æ˜ç¡®çš„ä¸“åˆ©è®¸å¯æ¡æ¬¾
- âš ï¸ **ç‰ˆæƒå£°æ˜è¦æ±‚**ï¼šä½¿ç”¨æ—¶å¿…é¡»ä¿ç•™åŸå§‹ç‰ˆæƒå£°æ˜


## ğŸ™ è‡´è°¢
æœ¬é¡¹ç›®æ ¸å¿ƒæ€æƒ³æ¥æºäº[PPTAgent](https://github.com/icip-cas/PPTAgent)æå‡ºçš„**å¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹+Agentæ¡†æ¶**ã€‚æˆ‘ä»¬è¯šæŒšæ„Ÿè°¢è¯¥é¡¹ç›®æä¾›çš„åˆ›æ–°æ€è·¯ï¼Œè¿™ä¸ºæœ¬å·¥ç¨‹çš„è®¾è®¡å’Œå®ç°å¥ å®šäº†å…³é”®åŸºç¡€ã€‚
